--liquibase formatted sql

--changeset ivan.sch:211118 create filter

CREATE TABLE public.filter
(
    id bigint GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    filter_name character varying(255),
    amount_value bigint,
    title_value character varying(255),
    date_value DATE,
    selection int,
    CONSTRAINT filter_pkey PRIMARY KEY (id)
);

--changeset ivan.sch:211118-1 create criteria table add data to criteria_table

CREATE TABLE public.criteria
(
    id bigint GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    criteria_text character varying(255) UNIQUE,
    CONSTRAINT criteria_pkey PRIMARY KEY (id)
);
insert into public.criteria (id, criteria_text) values (1, 'Amount');
insert into public.criteria (id, criteria_text) values (2, 'Title');
insert into public.criteria (id, criteria_text) values (3, 'Date');

--changeset ivan.sch:211118-2 add data to condition_table

ALTER TABLE filter ADD criteria_id bigint;
ALTER TABLE filter ADD CONSTRAINT fk_filter_criteria FOREIGN KEY (criteria_id) REFERENCES criteria(id);

--changeset ivan.sch:211118-3 add data to condition_table

CREATE TABLE public.condition
(
    id bigint GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    condition_text character varying(255),

    CONSTRAINT condition_pkey PRIMARY KEY (id)
);

ALTER TABLE condition ADD criteria_id bigint;
ALTER TABLE condition ADD CONSTRAINT fk_condition_criteria FOREIGN KEY (criteria_id) REFERENCES criteria(id);

insert into public.condition (id, criteria_id, condition_text) values (1, 1, 'Less than');
insert into public.condition (id, criteria_id, condition_text) values (2, 1, 'Less than or equal to');
insert into public.condition (id, criteria_id, condition_text) values (3, 1, 'Greater than');
insert into public.condition (id, criteria_id, condition_text) values (4, 1, 'Greater than or equal to');
insert into public.condition (id, criteria_id, condition_text) values (5, 1, 'Equal to');
insert into public.condition (id, criteria_id, condition_text) values (6, 1, 'Not equal to');
insert into public.condition (id, criteria_id, condition_text) values (7, 2, 'Contains');
insert into public.condition (id, criteria_id, condition_text) values (8, 2, 'Does not contain');
insert into public.condition (id, criteria_id, condition_text) values (9, 2, 'Equals');
insert into public.condition (id, criteria_id, condition_text) values (10, 3, 'Equal to');
insert into public.condition (id, criteria_id, condition_text) values (11, 3, 'Before');
insert into public.condition (id, criteria_id, condition_text) values (12, 3, 'On or before');
insert into public.condition (id, criteria_id, condition_text) values (13, 3, 'After');
insert into public.condition (id, criteria_id, condition_text) values (14, 3, 'On or after');

--changeset ivan.sch:211118-4 add data to condition_table

ALTER TABLE filter ADD condition_id bigint;
ALTER TABLE filter ADD CONSTRAINT fk_filter_condition FOREIGN KEY (condition_id) REFERENCES condition(id);

--changeset ivan.sch:211118-5 add data to filter_table
insert into public.filter (filter_name, criteria_id, condition_id, amount_value, title_value,
                           date_value, selection) values ('Filter 1', 1, 1, 24345, null, null, 1);
insert into public.filter (filter_name, criteria_id, condition_id, amount_value, title_value,
                           date_value, selection) values ('Filter 2', 2, 8, null, 'Wisercat', null, 2);
insert into public.filter (filter_name, criteria_id, condition_id, amount_value, title_value,
                           date_value, selection) values ('Filter 3', 3, 11, null, null, '2021-11-22', 3);
